GPU Prolog Script v1.14
This is a GPU node.
Enough GPUs available.
Allocating card 0
dj jul 10 14:57:23 BST 2025
Thu Jul 10 14:57:23 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.127.05             Driver Version: 550.127.05     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA GeForce RTX 3090        On  |   00000000:01:00.0 Off |                  N/A |
| 32%   34C    P8             31W /  350W |       1MiB /  24576MiB |      0%   E. Process |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA GeForce RTX 3090        On  |   00000000:C1:00.0 Off |                  N/A |
| 30%   26C    P8             25W /  350W |   14560MiB /  24576MiB |      0%   E. Process |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|    1   N/A  N/A     54197      C   python3                                     14554MiB |
+-----------------------------------------------------------------------------------------+
Parameters:
- img_size: 64
- train_bs: 16
- test_bs: 1
- drop_first: 0.1
- drop_last: 0.5
- use_T2W: True
- use_histo: False
- n_epochs: 50
- lr: 1e-06
- factor: 0.5
- patience: 4
- cooldown: 2
- λ_pixel: 10.0
- λ_perct: 0.01
- λ_ssim: 1.0
- λ_contrast: 1.0
- load_checkpoint: pretrain_PICAI
- finetune: False
- surgical_only: False


Creating model...
Creating datasets...
Loading model weights...
Starting training...

Epoch  0
Learning rate : 1e-06
Training Loss: 2.1534. Pixel: 0.0353, Perceptual: 108.8992, SSIM: 0.1876, Contrastive: 0.5239, 
Validation Loss: -1.2352. Pixel: 0.0415, Perceptual: 138.0580, SSIM: 0.2109, Contrastive: -3.2416, 
Traceback (most recent call last):
  File "/cluster/project7/ProsRegNet_CellCount/UNet_SR/finetune_contrastive.py", line 103, in <module>
    train_evaluate(model, train_dataloader, test_dataloader, optimizer, scheduler, args.n_epochs, checkpoint, losses, λ_loss)
  File "/cluster/project7/ProsRegNet_CellCount/UNet_SR/model/train_functions.py", line 117, in train_evaluate
    torch.save(model.state_dict(), CHECKPOINTS_FOLDER + name + '_best.pth')
  File "/cluster/project7/ProsRegNet_CellCount/CriDiff/CriDiff_env/lib/python3.9/site-packages/torch/serialization.py", line 618, in save
    with _open_zipfile_writer(f) as opened_zipfile:
  File "/cluster/project7/ProsRegNet_CellCount/CriDiff/CriDiff_env/lib/python3.9/site-packages/torch/serialization.py", line 492, in _open_zipfile_writer
    return container(name_or_buffer)
  File "/cluster/project7/ProsRegNet_CellCount/CriDiff/CriDiff_env/lib/python3.9/site-packages/torch/serialization.py", line 463, in __init__
    super().__init__(torch._C.PyTorchFileWriter(self.name))
RuntimeError: Parent directory /cluster/project7/ProsRegNet_CellCount/UNet_SR/checkpoints/./checkpoints does not exist.
dj jul 10 15:33:46 BST 2025
GPU Epilog Script v0.30
